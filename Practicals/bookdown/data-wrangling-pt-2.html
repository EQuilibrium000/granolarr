<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Data wrangling Pt. 2 | Geographic data science reproducible teaching resource in R Practical session materials</title>
  <meta name="description" content="Geographic data science reproducible teaching resource in RPractical session materials" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Data wrangling Pt. 2 | Geographic data science reproducible teaching resource in R Practical session materials" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Data wrangling Pt. 2 | Geographic data science reproducible teaching resource in R Practical session materials" />
  
  
  

<meta name="author" content="Stefano De Sabbata" />


<meta name="date" content="2020-01-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling-pt-1.html"/>
<link rel="next" href="reproducibility.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#session-info"><i class="fa fa-check"></i><b>0.1</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#the-r-programming-language"><i class="fa fa-check"></i><b>1.1</b> The R programming language</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-rstudio"><i class="fa fa-check"></i><b>1.1.1</b> Using RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#interpreting-values"><i class="fa fa-check"></i><b>1.2</b> Interpreting values</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>1.3</b> Variables</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-types"><i class="fa fa-check"></i><b>1.4</b> Basic types</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#numeric"><i class="fa fa-check"></i><b>1.4.1</b> Numeric</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#logical"><i class="fa fa-check"></i><b>1.4.2</b> Logical</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#character"><i class="fa fa-check"></i><b>1.4.3</b> Character</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#tidyverse"><i class="fa fa-check"></i><b>1.5</b> Tidyverse</a><ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#stringr"><i class="fa fa-check"></i><b>1.5.1</b> stringr</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#the-pipe-operator"><i class="fa fa-check"></i><b>1.5.2</b> The pipe operator</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#coding-style"><i class="fa fa-check"></i><b>1.6</b> Coding style</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exercise-1.1"><i class="fa fa-check"></i><b>1.7</b> Exercise 1.1</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exercise-1.2"><i class="fa fa-check"></i><b>1.8</b> Exercise 1.2</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>2</b> Data types</a><ul>
<li class="chapter" data-level="2.1" data-path="data-types.html"><a href="data-types.html#vectors"><i class="fa fa-check"></i><b>2.1</b> Vectors</a></li>
<li class="chapter" data-level="2.2" data-path="data-types.html"><a href="data-types.html#filtering"><i class="fa fa-check"></i><b>2.2</b> Filtering</a></li>
<li class="chapter" data-level="2.3" data-path="data-types.html"><a href="data-types.html#factors"><i class="fa fa-check"></i><b>2.3</b> Factors</a></li>
<li class="chapter" data-level="2.4" data-path="data-types.html"><a href="data-types.html#exercise-2.1"><i class="fa fa-check"></i><b>2.4</b> Exercise 2.1</a></li>
<li class="chapter" data-level="2.5" data-path="data-types.html"><a href="data-types.html#matrices-and-arrays"><i class="fa fa-check"></i><b>2.5</b> Matrices and arrays</a></li>
<li class="chapter" data-level="2.6" data-path="data-types.html"><a href="data-types.html#exercise-2.2"><i class="fa fa-check"></i><b>2.6</b> Exercise 2.2</a></li>
<li class="chapter" data-level="2.7" data-path="data-types.html"><a href="data-types.html#lists"><i class="fa fa-check"></i><b>2.7</b> Lists</a></li>
<li class="chapter" data-level="2.8" data-path="data-types.html"><a href="data-types.html#data-frames"><i class="fa fa-check"></i><b>2.8</b> Data frames</a></li>
<li class="chapter" data-level="2.9" data-path="data-types.html"><a href="data-types.html#exercise-2.3"><i class="fa fa-check"></i><b>2.9</b> Exercise 2.3</a></li>
<li class="chapter" data-level="2.10" data-path="data-types.html"><a href="data-types.html#solutions"><i class="fa fa-check"></i><b>2.10</b> Solutions</a><ul>
<li class="chapter" data-level="2.10.1" data-path="data-types.html"><a href="data-types.html#exercise-2.1-1"><i class="fa fa-check"></i><b>2.10.1</b> Exercise 2.1</a></li>
<li class="chapter" data-level="2.10.2" data-path="data-types.html"><a href="data-types.html#exercise-2.2-1"><i class="fa fa-check"></i><b>2.10.2</b> Exercise 2.2</a></li>
<li class="chapter" data-level="2.10.3" data-path="data-types.html"><a href="data-types.html#exercise-2.3-1"><i class="fa fa-check"></i><b>2.10.3</b> Exercise 2.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html"><i class="fa fa-check"></i><b>3</b> Control structures and Functions</a><ul>
<li class="chapter" data-level="3.1" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#conditional-structures"><i class="fa fa-check"></i><b>3.1</b> Conditional structures</a></li>
<li class="chapter" data-level="3.2" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#loops"><i class="fa fa-check"></i><b>3.2</b> Loops</a><ul>
<li class="chapter" data-level="3.2.1" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#conditional-loops"><i class="fa fa-check"></i><b>3.2.1</b> Conditional Loops</a></li>
<li class="chapter" data-level="3.2.2" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#deterministic-loops"><i class="fa fa-check"></i><b>3.2.2</b> Deterministic Loops</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#function-definition"><i class="fa fa-check"></i><b>3.3</b> Function definition</a></li>
<li class="chapter" data-level="3.4" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#exercise-6.1"><i class="fa fa-check"></i><b>3.4</b> Exercise 6.1</a></li>
<li class="chapter" data-level="3.5" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#data-checking"><i class="fa fa-check"></i><b>3.5</b> Data Checking</a></li>
<li class="chapter" data-level="3.6" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#exercise-6.2"><i class="fa fa-check"></i><b>3.6</b> Exercise 6.2</a></li>
<li class="chapter" data-level="3.7" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#solutions-1"><i class="fa fa-check"></i><b>3.7</b> Solutions</a><ul>
<li class="chapter" data-level="3.7.1" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#exercise-6.1-1"><i class="fa fa-check"></i><b>3.7.1</b> Exercise 6.1</a></li>
<li class="chapter" data-level="3.7.2" data-path="control-structures-and-functions.html"><a href="control-structures-and-functions.html#exercise-6.2-1"><i class="fa fa-check"></i><b>3.7.2</b> Exercise 6.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling Pt. 1</a><ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#working-with-rstudio"><i class="fa fa-check"></i><b>4.1</b> Working with RStudio</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#r-projects"><i class="fa fa-check"></i><b>4.1.1</b> R Projects</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#r-scripts"><i class="fa fa-check"></i><b>4.1.2</b> R Scripts</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#install-libraries"><i class="fa fa-check"></i><b>4.2</b> Install libraries</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#data-manipulation"><i class="fa fa-check"></i><b>4.3</b> Data manipulation</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#summarise"><i class="fa fa-check"></i><b>4.3.1</b> Summarise</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#select-and-filter"><i class="fa fa-check"></i><b>4.3.2</b> Select and filter</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#mutate"><i class="fa fa-check"></i><b>4.3.3</b> Mutate</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#arrange"><i class="fa fa-check"></i><b>4.3.4</b> Arrange</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#data-manipulation-example"><i class="fa fa-check"></i><b>4.4</b> Data manipulation example</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#exercise-3.1"><i class="fa fa-check"></i><b>4.5</b> Exercise 3.1</a></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-pt-1.html"><a href="data-wrangling-pt-1.html#solutions-2"><i class="fa fa-check"></i><b>4.6</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling Pt. 2</a><ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#table-manipulation"><i class="fa fa-check"></i><b>5.1</b> Table manipulation</a><ul>
<li class="chapter" data-level="5.1.1" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#long-and-wide-formats"><i class="fa fa-check"></i><b>5.1.1</b> Long and wide formats</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#join"><i class="fa fa-check"></i><b>5.1.2</b> Join</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#read-and-write-data"><i class="fa fa-check"></i><b>5.2</b> Read and write data</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#data-wrangling-example"><i class="fa fa-check"></i><b>5.3</b> Data wrangling example</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#re-shaping"><i class="fa fa-check"></i><b>5.3.1</b> Re-shaping</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#join-1"><i class="fa fa-check"></i><b>5.3.2</b> Join</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#exercise-3.1-1"><i class="fa fa-check"></i><b>5.4</b> Exercise 3.1</a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#exercise-3.2"><i class="fa fa-check"></i><b>5.5</b> Exercise 3.2</a></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-pt-2.html"><a href="data-wrangling-pt-2.html#solutions-3"><i class="fa fa-check"></i><b>5.6</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reproducibility.html"><a href="reproducibility.html"><i class="fa fa-check"></i><b>6</b> Reproducibility</a><ul>
<li class="chapter" data-level="6.1" data-path="reproducibility.html"><a href="reproducibility.html#markdown"><i class="fa fa-check"></i><b>6.1</b> Markdown</a><ul>
<li class="chapter" data-level="6.1.1" data-path="reproducibility.html"><a href="reproducibility.html#r-markdown"><i class="fa fa-check"></i><b>6.1.1</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reproducibility.html"><a href="reproducibility.html#exercise-5.1"><i class="fa fa-check"></i><b>6.2</b> Exercise 5.1</a></li>
<li class="chapter" data-level="6.3" data-path="reproducibility.html"><a href="reproducibility.html#exercise-5.2"><i class="fa fa-check"></i><b>6.3</b> Exercise 5.2</a></li>
<li class="chapter" data-level="6.4" data-path="reproducibility.html"><a href="reproducibility.html#git"><i class="fa fa-check"></i><b>6.4</b> Git</a><ul>
<li class="chapter" data-level="6.4.1" data-path="reproducibility.html"><a href="reproducibility.html#git-and-rstudio"><i class="fa fa-check"></i><b>6.4.1</b> Git and RStudio</a></li>
<li class="chapter" data-level="6.4.2" data-path="reproducibility.html"><a href="reproducibility.html#cloning-granolarr"><i class="fa fa-check"></i><b>6.4.2</b> Cloning granolarr</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="reproducibility.html"><a href="reproducibility.html#exercise-5.3"><i class="fa fa-check"></i><b>6.5</b> Exercise 5.3</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html"><i class="fa fa-check"></i><b>7</b> Exploratory analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#gglot2-recap"><i class="fa fa-check"></i><b>7.2</b> GGlot2 recap</a></li>
<li class="chapter" data-level="7.3" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#data-visualisation"><i class="fa fa-check"></i><b>7.3</b> Data visualisation</a><ul>
<li class="chapter" data-level="7.3.1" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#distributions"><i class="fa fa-check"></i><b>7.3.1</b> Distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#relationships"><i class="fa fa-check"></i><b>7.3.2</b> Relationships</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#exercise-7.1"><i class="fa fa-check"></i><b>7.4</b> Exercise 7.1</a></li>
<li class="chapter" data-level="7.5" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#exploratory-statistics"><i class="fa fa-check"></i><b>7.5</b> Exploratory statistics</a><ul>
<li class="chapter" data-level="7.5.1" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#descriptive-statistics"><i class="fa fa-check"></i><b>7.5.1</b> Descriptive statistics</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#exercise-7.2"><i class="fa fa-check"></i><b>7.6</b> Exercise 7.2</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i><b>8</b> Regression analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="regression-analysis.html"><a href="regression-analysis.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="regression-analysis.html"><a href="regression-analysis.html#anova"><i class="fa fa-check"></i><b>8.2</b> ANOVA</a><ul>
<li class="chapter" data-level="8.2.1" data-path="regression-analysis.html"><a href="regression-analysis.html#example"><i class="fa fa-check"></i><b>8.2.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="regression-analysis.html"><a href="regression-analysis.html#simple-regression"><i class="fa fa-check"></i><b>8.3</b> Simple regression</a><ul>
<li class="chapter" data-level="8.3.1" data-path="regression-analysis.html"><a href="regression-analysis.html#example-1"><i class="fa fa-check"></i><b>8.3.1</b> Example</a></li>
<li class="chapter" data-level="8.3.2" data-path="regression-analysis.html"><a href="regression-analysis.html#checking-assumptions"><i class="fa fa-check"></i><b>8.3.2</b> Checking assumptions</a></li>
<li class="chapter" data-level="8.3.3" data-path="regression-analysis.html"><a href="regression-analysis.html#how-to-report"><i class="fa fa-check"></i><b>8.3.3</b> How to report</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="regression-analysis.html"><a href="regression-analysis.html#multiple-regression"><i class="fa fa-check"></i><b>8.4</b> Multiple regression</a><ul>
<li class="chapter" data-level="8.4.1" data-path="regression-analysis.html"><a href="regression-analysis.html#example-2"><i class="fa fa-check"></i><b>8.4.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="regression-analysis.html"><a href="regression-analysis.html#exercise-9.1"><i class="fa fa-check"></i><b>8.5</b> Exercise 9.1</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="geodemographic-classification.html"><a href="geodemographic-classification.html"><i class="fa fa-check"></i><b>9</b> Geodemographic classification</a><ul>
<li class="chapter" data-level="9.1" data-path="geodemographic-classification.html"><a href="geodemographic-classification.html#introduction-2"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Geographic data science reproducible teaching resource in R<br/>Practical session materials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling-pt.-2" class="section level1">
<h1><span class="header-section-number">5</span> Data wrangling Pt. 2</h1>
<p><em><a href="https://stefanodesabbata.com">Stefano De Sabbata</a></em></p>
<p><a href="https://github.com/sdesabbata/granolarr">This work</a> is licensed under the <a href="https://www.gnu.org/licenses/gpl-3.0.html">GNU General Public License v3.0</a>. Contains public sector information licensed under the <a href="http://www.nationalarchives.gov.uk/doc/open-government-licence">Open Government Licence v3.0</a>.</p>
<p>This section illustrates the re-shape and join functionalities of the Tidyverse libraries using simple examples. The following sections instead present a more complex example, loading and wrangling with data related to the <a href="https://github.com/geogale/2011OAC">2011 Output Area Classification</a> and the <a href="https://www.gov.uk/government/statistics/english-indices-of-deprivation-2015">Indexes of Multiple Deprivation 2015</a>.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb248-2" data-line-number="2"><span class="kw">library</span>(knitr)</a></code></pre></div>
<div id="table-manipulation" class="section level2">
<h2><span class="header-section-number">5.1</span> Table manipulation</h2>
<div id="long-and-wide-formats" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Long and wide formats</h3>
<p>Tabular data are usually presented in two different formats.</p>
<ul>
<li><strong>Wide</strong>: this is the most common approach, where each real-world entity (e.g. a city) is represented by <em>one single row</em> and its attributes are represented through different columns (e.g., a column representing the total population in the area, another column representing the size of the area, etc.).</li>
</ul>
<table>
<thead>
<tr class="header">
<th>City</th>
<th>Population</th>
<th>Area</th>
<th>Density</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Leicester</td>
<td>329,839</td>
<td>73.3</td>
<td>4,500</td>
</tr>
<tr class="even">
<td>Nottingham</td>
<td>321,500</td>
<td>74.6</td>
<td>4,412</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Long</strong>: this is probably a less common approach, but still necessary in many cases, where each real-world entity (e.g. a city) is represented by <em>multiple rows</em>, each one reporting only one of its attributes. In this case, one column is used to indicate which attribute each row represent, and another column is used to report the value.</li>
</ul>
<table>
<thead>
<tr class="header">
<th>City</th>
<th>Attribute</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Leicester</td>
<td>Population</td>
<td>329,839</td>
</tr>
<tr class="even">
<td>Leicester</td>
<td>Area</td>
<td>73.3</td>
</tr>
<tr class="odd">
<td>Leicester</td>
<td>Density</td>
<td>4,500</td>
</tr>
<tr class="even">
<td>Nottingham</td>
<td>Population</td>
<td>321,500</td>
</tr>
<tr class="odd">
<td>Nottingham</td>
<td>Area</td>
<td>74.6</td>
</tr>
<tr class="even">
<td>Nottingham</td>
<td>Density</td>
<td>4,412</td>
</tr>
</tbody>
</table>
<p>The <code>tidyr</code> library provides two functions that allow transforming wide-formatted data to a long format, and vice-versa. Please take your time to understand the example below and check out the <a href="https://tidyr.tidyverse.org/"><code>tidyr</code> help pages</a> before continuing.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" data-line-number="1">city_info_wide &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb249-2" data-line-number="2">  <span class="dt">City =</span> <span class="kw">c</span>(<span class="st">&quot;Leicester&quot;</span>, <span class="st">&quot;Nottingham&quot;</span>),</a>
<a class="sourceLine" id="cb249-3" data-line-number="3">  <span class="dt">Population =</span> <span class="kw">c</span>(<span class="dv">329839</span>, <span class="dv">321500</span>),</a>
<a class="sourceLine" id="cb249-4" data-line-number="4">  <span class="dt">Area =</span> <span class="kw">c</span>(<span class="fl">73.3</span>, <span class="fl">74.6</span>),</a>
<a class="sourceLine" id="cb249-5" data-line-number="5">  <span class="dt">Density =</span> <span class="kw">c</span>(<span class="dv">4500</span>, <span class="dv">4412</span>)</a>
<a class="sourceLine" id="cb249-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb249-7" data-line-number="7"></a>
<a class="sourceLine" id="cb249-8" data-line-number="8"><span class="kw">kable</span>(city_info_wide)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="right">Population</th>
<th align="right">Area</th>
<th align="right">Density</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">321500</td>
<td align="right">74.6</td>
<td align="right">4412</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" data-line-number="1">city_info_long &lt;-<span class="st"> </span>city_info_wide <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb250-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>(</a>
<a class="sourceLine" id="cb250-3" data-line-number="3">    <span class="co"># exclude IDs (city names) from gathering</span></a>
<a class="sourceLine" id="cb250-4" data-line-number="4">    <span class="op">-</span>City,</a>
<a class="sourceLine" id="cb250-5" data-line-number="5">    <span class="co"># name for the new key column</span></a>
<a class="sourceLine" id="cb250-6" data-line-number="6">    <span class="dt">key =</span> <span class="st">&quot;Attribute&quot;</span>,</a>
<a class="sourceLine" id="cb250-7" data-line-number="7">    <span class="co"># name for the new value column</span></a>
<a class="sourceLine" id="cb250-8" data-line-number="8">    <span class="dt">value =</span> <span class="st">&quot;Value&quot;</span></a>
<a class="sourceLine" id="cb250-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb250-10" data-line-number="10"></a>
<a class="sourceLine" id="cb250-11" data-line-number="11"><span class="kw">kable</span>(city_info_long)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="left">Attribute</th>
<th align="right">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="left">Population</td>
<td align="right">329839.0</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="left">Population</td>
<td align="right">321500.0</td>
</tr>
<tr class="odd">
<td align="left">Leicester</td>
<td align="left">Area</td>
<td align="right">73.3</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="left">Area</td>
<td align="right">74.6</td>
</tr>
<tr class="odd">
<td align="left">Leicester</td>
<td align="left">Density</td>
<td align="right">4500.0</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="left">Density</td>
<td align="right">4412.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" data-line-number="1">city_info_back_to_wide &lt;-<span class="st"> </span>city_info_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb251-2" data-line-number="2"><span class="st">  </span><span class="kw">spread</span>(</a>
<a class="sourceLine" id="cb251-3" data-line-number="3">    <span class="co"># specify key column</span></a>
<a class="sourceLine" id="cb251-4" data-line-number="4">    <span class="dt">key =</span> <span class="st">&quot;Attribute&quot;</span>,</a>
<a class="sourceLine" id="cb251-5" data-line-number="5">    <span class="co"># specify value column</span></a>
<a class="sourceLine" id="cb251-6" data-line-number="6">    <span class="dt">value =</span> <span class="st">&quot;Value&quot;</span></a>
<a class="sourceLine" id="cb251-7" data-line-number="7">  )</a>
<a class="sourceLine" id="cb251-8" data-line-number="8"></a>
<a class="sourceLine" id="cb251-9" data-line-number="9"><span class="kw">kable</span>(city_info_back_to_wide)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="right">Area</th>
<th align="right">Density</th>
<th align="right">Population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="right">329839</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">74.6</td>
<td align="right">4412</td>
<td align="right">321500</td>
</tr>
</tbody>
</table>
</div>
<div id="join" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Join</h3>
<p>A join operation combines two tables into one by matching rows that have the same values in the specified column. This operation is usually executed on columns containing identifiers, which are matched through different tables containing different data about the same real-world entities. For instance, the table below presents the telephone prefixes for two cities. That information can be combined with the data present in the wide-formatted table above through a join operation on the columns containing the city names. As the two tables do not contain all the same cities, if a full join operation is executed, some cells have no values assigned.</p>
<table>
<thead>
<tr class="header">
<th>City</th>
<th>TelephonePrefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Leicester</td>
<td>0116</td>
</tr>
<tr class="even">
<td>Birmingham</td>
<td>0121</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th>City</th>
<th>Population</th>
<th>Area</th>
<th>Density</th>
<th>TelephonePrefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Leicester</td>
<td>329,839</td>
<td>73.3</td>
<td>4,500</td>
<td>0116</td>
</tr>
<tr class="even">
<td>Nottingham</td>
<td>321,500</td>
<td>74.6</td>
<td>4,412</td>
<td></td>
</tr>
<tr class="odd">
<td>Birmingham</td>
<td></td>
<td></td>
<td></td>
<td>0121</td>
</tr>
</tbody>
</table>
<p>As discussed in the lecture, the <code>dplyr</code> library offers different types of join operations, which correspond to the different <code>SQL</code> joins illustrated in the image below. The use and implications of these different types of joins will be discussed in more detail in the GY7708 module next semester.</p>
<div class="figure">
<img src="Images/joins.png" alt="by C.L. Moffatt, licensed under The Code Project Open License (CPOL)" style="width:75.0%" />
<p class="caption">by <a href="https://www.codeproject.com/articles/33052/visual-representation-of-sql-joins">C.L. Moffatt</a>, licensed under <a href="https://www.codeproject.com/info/cpol10.aspx">The Code Project Open License (CPOL)</a></p>
</div>
<!--
<font size="4">
<a href="https://www.codeproject.com/articles/33052/visual-representation-of-sql-joins">by C.L. Moffatt</a>, licensed under <a href="https://www.codeproject.com/info/cpol10.aspx">The Code Project Open License (CPOL)</a>
</font>
-->
<p>Please take your time to understand the example below and check out the <a href="https://dplyr.tidyverse.org/reference/join.html">related <code>dplyr</code> help pages</a> before continuing. Note how the result of the join operations is <em>not</em> saved to a variable. The function <code>kable</code> is added after each join operation through a pipe <code>%&gt;%</code> to display the resulting table in a nice format.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" data-line-number="1">city_telephone_prexix &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb252-2" data-line-number="2">  <span class="dt">City =</span> <span class="kw">c</span>(<span class="st">&quot;Leicester&quot;</span>, <span class="st">&quot;Birmingham&quot;</span>),</a>
<a class="sourceLine" id="cb252-3" data-line-number="3">  <span class="dt">TelephonPrefix =</span> <span class="kw">c</span>(<span class="st">&quot;0116&quot;</span>, <span class="st">&quot;0121&quot;</span>)</a>
<a class="sourceLine" id="cb252-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb252-5" data-line-number="5"></a>
<a class="sourceLine" id="cb252-6" data-line-number="6"><span class="kw">kable</span>(city_telephone_prexix)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="left">TelephonPrefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Birmingham</td>
<td align="left">0121</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" data-line-number="1"><span class="kw">full_join</span>(</a>
<a class="sourceLine" id="cb253-2" data-line-number="2">    city_info_wide, city_telephone_prexix,</a>
<a class="sourceLine" id="cb253-3" data-line-number="3">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;City&quot;</span> =<span class="st"> &quot;City&quot;</span>)</a>
<a class="sourceLine" id="cb253-4" data-line-number="4">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb253-5" data-line-number="5"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="right">Population</th>
<th align="right">Area</th>
<th align="right">Density</th>
<th align="left">TelephonPrefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">321500</td>
<td align="right">74.6</td>
<td align="right">4412</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Birmingham</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0121</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" data-line-number="1"><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb254-2" data-line-number="2">    city_info_wide, city_telephone_prexix,</a>
<a class="sourceLine" id="cb254-3" data-line-number="3">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;City&quot;</span> =<span class="st"> &quot;City&quot;</span>)</a>
<a class="sourceLine" id="cb254-4" data-line-number="4">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb254-5" data-line-number="5"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="right">Population</th>
<th align="right">Area</th>
<th align="right">Density</th>
<th align="left">TelephonPrefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Nottingham</td>
<td align="right">321500</td>
<td align="right">74.6</td>
<td align="right">4412</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" data-line-number="1"><span class="kw">right_join</span>(</a>
<a class="sourceLine" id="cb255-2" data-line-number="2">    city_info_wide, city_telephone_prexix,</a>
<a class="sourceLine" id="cb255-3" data-line-number="3">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;City&quot;</span> =<span class="st"> &quot;City&quot;</span>)</a>
<a class="sourceLine" id="cb255-4" data-line-number="4">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb255-5" data-line-number="5"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="right">Population</th>
<th align="right">Area</th>
<th align="right">Density</th>
<th align="left">TelephonPrefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
<tr class="even">
<td align="left">Birmingham</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">0121</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" data-line-number="1"><span class="kw">inner_join</span>(</a>
<a class="sourceLine" id="cb256-2" data-line-number="2">    city_info_wide, city_telephone_prexix,</a>
<a class="sourceLine" id="cb256-3" data-line-number="3">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;City&quot;</span> =<span class="st"> &quot;City&quot;</span>)</a>
<a class="sourceLine" id="cb256-4" data-line-number="4">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb256-5" data-line-number="5"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">City</th>
<th align="right">Population</th>
<th align="right">Area</th>
<th align="right">Density</th>
<th align="left">TelephonPrefix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">329839</td>
<td align="right">73.3</td>
<td align="right">4500</td>
<td align="left">0116</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="read-and-write-data" class="section level2">
<h2><span class="header-section-number">5.2</span> Read and write data</h2>
<p>The <a href="https://readr.tidyverse.org/index.html"><code>readr</code> library</a> (also part of the Tidyverse) provides a series of functions that can be used to load from and save data to different file formats.</p>
<p>Download from the <a href="https://github.com/sdesabbata/granolarr/tree/master/Data">Data</a> folder of the repository the following files:</p>
<ul>
<li><code>2011_OAC_Raw_uVariables_Leicester.csv</code></li>
<li><code>IndexesMultipleDeprivation2015_Leicester.csv</code></li>
</ul>
<p>Create a <em>Practical_202</em> project and make sure it is activated and thus the <em>Practical_202</em> showing in the <em>File</em> tab in the bottom-right panel. Upload the two files to the <em>Practical_202</em> folder by clicking on the <em>Upload</em> button and selecting the files from your computer (at the time of writing, Chrome seems to upload the file correctly, whereas it might be necessary to change the names of the files after upload using Microsoft Edge).</p>
<p>Create a new R script named <code>Data_Wrangling_Example.R</code> in the <em>Practical_202</em> project, and add <code>library(tidyverse)</code> as the first line. Use that new script for this and the following sections of this practical session.</p>
<p>The <a href="https://github.com/geogale/2011OAC">2011 Output Area Classification</a> (2011 OAC) is a geodemographic classification of the census Output Areas (OA) of the UK, which was created by <a href="http://josis.org/index.php/josis/article/viewArticle/232">Gale et al. (2016)</a> starting from an initial set of 167 prospective variables from the United Kingdom Census 2011: 86 were removed, 41 were retained as they are, and 40 were combined, leading to a final set of 60 variables. <a href="http://josis.org/index.php/josis/article/viewArticle/232">Gale et al. (2016)</a> finally used the k-means clustering approach to create 8 clusters or supergroups (see <a href="https://oac.datashine.org.uk">map at datashine.org.uk</a>), as well as 26 groups and 76 subgroups. The dataset in the file <code>2011_OAC_Raw_uVariables_Leicester.csv</code> contains all the original 167 variables, as well as the resulting groups, for the city of Leicester. The full variable names can be found in the file <code>2011_OAC_Raw_uVariables_Lookup.csv</code>.</p>
<p>The <a href="https://www.gov.uk/government/statistics/english-indices-of-deprivation-2015">Indexes of Multiple Deprivation 2015</a> (see <a href="https://maps.cdrc.ac.uk/#/geodemographics/imde2015">map at cdrc.ac.uk</a>) are based on a series of variables across seven distinct domains of deprivation which are combined to calculate the Index of Multiple Deprivation 2015 (IMD 2015). That is an overall measure of multiple deprivations experienced by people living in an area. These indexes are calculated for every Lower layer Super Output Area (LSOA), which are larger geographic unit than the OAs used for the 2011 OAC. The dataset in the file <code>IndexesMultipleDeprivation2015_Leicester.csv</code> contains the main Index of Multiple Deprivation, as well as the values for the seven distinct domains of deprivation, and two additional indexes regarding deprivation affecting children and older people. The dataset includes scores, ranks (where 1 indicates the most deprived area), and decile (i.e., the first decile includes the 10% most deprived areas in England).</p>
<!--
Note that the `~` in the path below indicates the home folder -- a different path might be necessary if you execute this on a windows machine, please see also [file.path](https://stat.ethz.ch/R-manual/R-devel/library/base/html/file.path.html).
-->
<p>The <code>read_csv</code> function reads a <em>Comma Separated Values (CSV)</em> file from the path provided as the first argument. The code below loads the 2011 OAC dataset. The <code>read_csv</code> instruction throws a warning that shows the assumptions about the data types used when loading the data. As illustrated by the output of the last line of code, the data are loaded as a tibble 969 x 190, that is 969 rows – one for each OA – and 190 columns, 167 of which represent the input variables used to create the 2011 OAC.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" data-line-number="1">leicester_2011OAC &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;2011_OAC_Raw_uVariables_Leicester.csv&quot;</span>)</a>
<a class="sourceLine" id="cb257-2" data-line-number="2"></a>
<a class="sourceLine" id="cb257-3" data-line-number="3">leicester_2011OAC <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb257-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(OA11CD,LSOA11CD, supgrpcode,supgrpname,Total_Population) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb257-5" data-line-number="5"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb257-6" data-line-number="6"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">OA11CD</th>
<th align="left">LSOA11CD</th>
<th align="right">supgrpcode</th>
<th align="left">supgrpname</th>
<th align="right">Total_Population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">E00169553</td>
<td align="left">E01013648</td>
<td align="right">2</td>
<td align="left">Cosmopolitans</td>
<td align="right">714</td>
</tr>
<tr class="even">
<td align="left">E00069303</td>
<td align="left">E01013739</td>
<td align="right">4</td>
<td align="left">Multicultural Metropolitans</td>
<td align="right">623</td>
</tr>
<tr class="odd">
<td align="left">E00168096</td>
<td align="left">E01013689</td>
<td align="right">2</td>
<td align="left">Cosmopolitans</td>
<td align="right">708</td>
</tr>
</tbody>
</table>
<p>The code below loads the IMD 2015 dataset.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" data-line-number="1"><span class="co"># Load Indexes of Multiple deprivation data</span></a>
<a class="sourceLine" id="cb258-2" data-line-number="2">leicester_IMD2015 &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;IndexesMultipleDeprivation2015_Leicester.csv&quot;</span>)</a></code></pre></div>
<p>The function <code>write_csv</code> can be used to save a dataset as a <code>csv</code> file. For instance, the code below uses <code>tidyverse</code> functions and the pipe operator <code>%&gt;%</code> to:</p>
<ol style="list-style-type: decimal">
<li><strong>read</strong> the 2011 OAC dataset again directly from the file, but without storing it into a variable;</li>
<li><strong>select</strong> the OA code variable <code>OA11CD</code>, and the two variables representing the code and name of the supergroup assigned to each OA by the 2011 OAC (<code>supgrpcode</code> and <code>supgrpname</code> respectively);</li>
<li><strong>filter</strong> only those OA in the supergroup <em>Suburbanites</em> (code <code>6</code>);</li>
<li><strong>write</strong> the results to a file named <em>Leicester_Suburbanites.csv</em> in your home folder.</li>
</ol>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" data-line-number="1"><span class="kw">read_csv</span>(<span class="st">&quot;2011_OAC_Raw_uVariables_Leicester.csv&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb259-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(OA11CD, supgrpcode, supgrpname) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb259-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(supgrpcode <span class="op">==</span><span class="st"> </span><span class="dv">6</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb259-4" data-line-number="4"><span class="st">  </span><span class="kw">write_csv</span>(<span class="st">&quot;~/Leicester_Suburbanites.csv&quot;</span>)</a></code></pre></div>
</div>
<div id="data-wrangling-example" class="section level2">
<h2><span class="header-section-number">5.3</span> Data wrangling example</h2>
<div id="re-shaping" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Re-shaping</h3>
<p>The IMD 2015 data are in a <em>long</em> format, which means that every area is represented by more than one row: the column <code>Value</code> presents the value; the column <code>IndicesOfDeprivation</code> indicates which index the value refers to; the column <code>Measurement</code> indicates whether the value is a score, rank, or decile. The code below illustrates the data format for the LSOA including the University of Leicester (feature code <code>E01013649</code>).</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" data-line-number="1">leicester_IMD2015 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb260-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(FeatureCode <span class="op">==</span><span class="st"> &quot;E01013649&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb260-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(FeatureCode, IndicesOfDeprivation, Measurement, Value)</a></code></pre></div>
<pre><code>## # A tibble: 30 x 4
##    FeatureCode IndicesOfDeprivation                      Measurement  Value
##    &lt;chr&gt;       &lt;chr&gt;                                     &lt;chr&gt;        &lt;dbl&gt;
##  1 E01013649   Income Deprivation Domain                 Score        0.07 
##  2 E01013649   Employment Deprivation Domain             Score        0.075
##  3 E01013649   Income Deprivation Affecting Children In… Score        0.087
##  4 E01013649   Income Deprivation Affecting Older Peopl… Score        0.153
##  5 E01013649   Health Deprivation and Disability Domain  Score        0.272
##  6 E01013649   Index of Multiple Deprivation (IMD)       Score       19.7  
##  7 E01013649   Education, Skills and Training Domain     Score        2.19 
##  8 E01013649   Barriers to Housing and Services Domain   Score       14.3  
##  9 E01013649   Living Environment Deprivation Domain     Score       57.2  
## 10 E01013649   Crime Domain                              Score        1.16 
## # … with 20 more rows</code></pre>
<p>In the following section, the analysis aims to explore how certain census variables vary in areas with different deprivation levels. Thus, we need to extract the <code>Decile</code> rows from the IMD 2015 dataset and transform the data in a <em>wide</em> format, where each index is represented as a separate column.</p>
<p>To that purpose, we also need to change the name of the indexes slightly, to exclude spaces and punctuation, so that the new column names are simpler than the original text, and can be used as column names. That part of the manipulation is performed using <code>mutate</code> and functions from the <a href="https://stringr.tidyverse.org/"><code>stringr</code> library</a>.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" data-line-number="1">leicester_IMD2015_decile_wide &lt;-<span class="st"> </span>leicester_IMD2015 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb262-2" data-line-number="2"><span class="st">  </span><span class="co"># Select only Socres</span></a>
<a class="sourceLine" id="cb262-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Measurement <span class="op">==</span><span class="st"> &quot;Decile&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb262-4" data-line-number="4"><span class="st">  </span><span class="co"># Trim names of IndicesOfDeprivation</span></a>
<a class="sourceLine" id="cb262-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">IndicesOfDeprivation =</span> <span class="kw">str_replace_all</span>(IndicesOfDeprivation, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">s&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb262-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">IndicesOfDeprivation =</span> <span class="kw">str_replace_all</span>(IndicesOfDeprivation, <span class="st">&quot;[:punct:]&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb262-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">IndicesOfDeprivation =</span> <span class="kw">str_replace_all</span>(IndicesOfDeprivation, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">(&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb262-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">IndicesOfDeprivation =</span> <span class="kw">str_replace_all</span>(IndicesOfDeprivation, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb262-9" data-line-number="9"><span class="st">  </span><span class="co"># Spread</span></a>
<a class="sourceLine" id="cb262-10" data-line-number="10"><span class="st">  </span><span class="kw">spread</span>(</a>
<a class="sourceLine" id="cb262-11" data-line-number="11">    <span class="dt">key =</span> IndicesOfDeprivation,</a>
<a class="sourceLine" id="cb262-12" data-line-number="12">    <span class="dt">value =</span> Value</a>
<a class="sourceLine" id="cb262-13" data-line-number="13">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb262-14" data-line-number="14"><span class="st">  </span><span class="co"># Drop columns</span></a>
<a class="sourceLine" id="cb262-15" data-line-number="15"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>DateCode, <span class="op">-</span>Measurement, <span class="op">-</span>Units)</a></code></pre></div>
<p>Let’s compare the columns of the original <em>long</em> IMD 2015 dataset with the <em>wide</em> dataset created above.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" data-line-number="1"><span class="kw">colnames</span>(leicester_IMD2015)</a></code></pre></div>
<pre><code>## [1] &quot;FeatureCode&quot;          &quot;DateCode&quot;             &quot;Measurement&quot;         
## [4] &quot;Units&quot;                &quot;Value&quot;                &quot;IndicesOfDeprivation&quot;</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" data-line-number="1"><span class="kw">colnames</span>(leicester_IMD2015_decile_wide)</a></code></pre></div>
<pre><code>##  [1] &quot;FeatureCode&quot;                                     
##  [2] &quot;BarrierstoHousingandServicesDomain&quot;              
##  [3] &quot;CrimeDomain&quot;                                     
##  [4] &quot;EducationSkillsandTrainingDomain&quot;                
##  [5] &quot;EmploymentDeprivationDomain&quot;                     
##  [6] &quot;HealthDeprivationandDisabilityDomain&quot;            
##  [7] &quot;IncomeDeprivationAffectingChildrenIndexIDACI&quot;    
##  [8] &quot;IncomeDeprivationAffectingOlderPeopleIndexIDAOPI&quot;
##  [9] &quot;IncomeDeprivationDomain&quot;                         
## [10] &quot;IndexofMultipleDeprivationIMD&quot;                   
## [11] &quot;LivingEnvironmentDeprivationDomain&quot;</code></pre>
<p>Thus, we now have only one row representing the LSOA including the University of Leicester (feature code <code>E01013649</code>) and the main Index of Multiple Deprivations is now represented by the column <code>IndexofMultipleDeprivationIMD</code>. The value reported is the same – that is 5, which means that the selected LSOA is estimated to be in the range 40-50% most deprived areas in England – but we changed the data format.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" data-line-number="1"><span class="co"># Original long IMD 2015 dataset</span></a>
<a class="sourceLine" id="cb267-2" data-line-number="2">leicester_IMD2015 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb267-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(</a>
<a class="sourceLine" id="cb267-4" data-line-number="4">    FeatureCode <span class="op">==</span><span class="st"> &quot;E01013649&quot;</span>,</a>
<a class="sourceLine" id="cb267-5" data-line-number="5">    IndicesOfDeprivation <span class="op">==</span><span class="st"> &quot;Index of Multiple Deprivation (IMD)&quot;</span>,</a>
<a class="sourceLine" id="cb267-6" data-line-number="6">    Measurement <span class="op">==</span><span class="st"> &quot;Decile&quot;</span></a>
<a class="sourceLine" id="cb267-7" data-line-number="7">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb267-8" data-line-number="8"><span class="st">  </span><span class="kw">select</span>(FeatureCode, IndicesOfDeprivation, Measurement, Value)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   FeatureCode IndicesOfDeprivation                Measurement Value
##   &lt;chr&gt;       &lt;chr&gt;                               &lt;chr&gt;       &lt;dbl&gt;
## 1 E01013649   Index of Multiple Deprivation (IMD) Decile          5</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" data-line-number="1"><span class="co"># New wide IMD 2015 dataset</span></a>
<a class="sourceLine" id="cb269-2" data-line-number="2">leicester_IMD2015_decile_wide <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb269-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(FeatureCode <span class="op">==</span><span class="st"> &quot;E01013649&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb269-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(FeatureCode, IndexofMultipleDeprivationIMD)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   FeatureCode IndexofMultipleDeprivationIMD
##   &lt;chr&gt;                               &lt;dbl&gt;
## 1 E01013649                               5</code></pre>
</div>
<div id="join-1" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Join</h3>
<p>As discussed above, two tables can be joined using a common column of identifiers. We can thus join the 2011 OAC and the IMD 2015 datasets into a single table. The LSOA code included in the 2011 OAC table is used to match that information with the corresponding row in the IMD 2015. The resulting table provides all the information from the 2011 OAC for each OA, plus the Index of Multiple Deprivations decile for the LSOA containing each OA.</p>
<p>That operation can be carried out using the function <code>merge</code>, and specifying the common column (or columns, if more than one is to be used as identifier) as argument of <code>by</code>.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" data-line-number="1">leicester_2011OAC_IMD2015 &lt;-<span class="st"> </span>leicester_2011OAC <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb271-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(leicester_IMD2015_decile_wide, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;LSOA11CD&quot;</span> =<span class="st"> &quot;FeatureCode&quot;</span>))</a></code></pre></div>
<p>Once the result is stored into the variable <code>leicester_2011OAC_IMD2015</code>, further analysis can be carried out. For instance, <code>count</code> can be used to count how many OAs fall into each 2011 OAC supergroup and decile of the Index of Multiple Deprivations.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" data-line-number="1">leicester_2011OAC_IMD2015 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb272-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(supgrpname, IndexofMultipleDeprivationIMD)</a></code></pre></div>
<pre><code>## # A tibble: 46 x 3
##    supgrpname                IndexofMultipleDeprivationIMD     n
##    &lt;chr&gt;                                             &lt;dbl&gt; &lt;int&gt;
##  1 Constrained City Dwellers                             1    30
##  2 Constrained City Dwellers                             2     3
##  3 Constrained City Dwellers                             3     2
##  4 Constrained City Dwellers                             6     1
##  5 Cosmopolitans                                         2    25
##  6 Cosmopolitans                                         3    15
##  7 Cosmopolitans                                         4    15
##  8 Cosmopolitans                                         5     8
##  9 Cosmopolitans                                         6    10
## 10 Cosmopolitans                                         8    10
## # … with 36 more rows</code></pre>
<p>As another example, the code below can be used to group OAs based on the decile and then calculate the percentage of adults not in employment using the
<code>u074</code> (<em>No adults in employment in household: With dependent children</em>) and <code>u075</code> (<em>No adults in employment in household: No dependent children</em>) variables from the 2011 OAC dataset.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" data-line-number="1">leicester_2011OAC_IMD2015 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb274-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(IndexofMultipleDeprivationIMD) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb274-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb274-4" data-line-number="4">    <span class="dt">adults_not_empl_perc =</span> (<span class="kw">sum</span>(u074 <span class="op">+</span><span class="st"> </span>u075) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(Total_Population)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb274-5" data-line-number="5">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb274-6" data-line-number="6"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">IndexofMultipleDeprivationIMD</th>
<th align="right">adults_not_empl_perc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">17.071876</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">14.191205</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">10.405029</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">9.966309</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">11.337036</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">10.710509</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">10.641026</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9.686658</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">9.898140</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exercise-3.1-1" class="section level2">
<h2><span class="header-section-number">5.4</span> Exercise 3.1</h2>
<p>Extend the code in the script <code>Data_Wrangling_Example.R</code> to include the code necessary to solve the questions below.</p>
<p><strong>Question 3.1.1:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> library to generate a table showing the percentage of EU citizens over total population, calculated grouping OAs by the related decile of the Index of Multiple Deprivations, but only accounting for areas classified as Cosmopolitans or Ethnicity Central or Multicultural Metropolitans.</p>
<p><strong>Question 3.1.2:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> library to generate a table showing the percentage of EU citizens over total population, calculated grouping OAs by the related supergroup in the 2011 OAC, but only accounting for areas in the top 5 deciles of the Index of Multiple Deprivations.</p>
<p><strong>Question 3.1.3:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> library to generate a table showing the percentage of people aged 65 and above, calculated grouping OAs by the related supergroup in the 2011 OAC and decile of the Index of Multiple Deprivations, and ordering the table by the calculated value in a descending order.</p>
</div>
<div id="exercise-3.2" class="section level2">
<h2><span class="header-section-number">5.5</span> Exercise 3.2</h2>
<p>Extend the code in the script <code>Data_Wrangling_Example.R</code> to include the code necessary to solve the questions below.</p>
<p><strong>Question 3.2.1:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> and <code>tidyr</code> libraries to generate a long format of the <code>leicester_2011OAC_IMD2015</code> table only including the values (census variables) used in <em>Question 3.1.3</em>.</p>
<p><strong>Question 3.2.2:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> and <code>tidyr</code> libraries to generate a table similar to the one generated for <em>Question 3.2.1</em>, but showing the values as percentages over total population.</p>
</div>
<div id="solutions-3" class="section level2">
<h2><span class="header-section-number">5.6</span> Solutions</h2>
<p>A full R Script including the code for the analysis presented in this practical session and the solutions to the 5 questions above is available in the Exercise folder of the repository (<code>202_X_Data_Wrangling2_Example.R</code>). Upload the prepared script to your <em>Practical_202</em> project folder, click on the uploaded file to open it in a new editor tab and compare it to your script.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling-pt-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reproducibility.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
